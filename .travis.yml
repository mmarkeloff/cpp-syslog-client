language: cpp

compiler:
    - gcc

services:
    - docker

before_script:
    - docker build -t cpp-syslog-client -f test_pkg/Dockerfile .
    - mkdir test/unit/build
    - cd test/unit/build
    - cmake ..
    - make

jobs:
  include:
    - stage: "Unit tests"
      name: "Unit tests"
      script: make test
    - stage: "Integration tests"
      name: "Integration tests"
      script: docker run cpp-syslog-client
